#!/bin/bash
echo "" > cis
echo "IP:        `hostname -i`" >> cis
echo "HOSTNAME:  `hostname -f`" >> cis
echo "Date:      `date` "       >> cis
echo "" >> cis
echo "1.1.1.1 Ensure mounting of cramfs filesystems is disabled (Scored) " >> cis
echo "command :  modprobe -n -v cramfs" >> cis
modprobe -n -v cramfs >> cis ; modprobe -n -v cramfs 2>> cis
echo "command : lsmod | grep cramfs " >> cis
lsmod | grep cramfs >> cis ; lsmod | grep cramfs 2>> cis

echo "1.1.1.2 Ensure mounting of freevxfs filesystems is disabled (Scored) " >> cis
echo "command :  modprobe -n -v freevxfs " >> cis
modprobe -n -v freevxfs  >> cis ; modprobe -n -v freevxfs  2>> cis
echo "command : lsmod | grep freevxfs " >> cis
lsmod | grep freevxfs >> cis ; lsmod | grep freevxfs 2>> cis

echo "1.1.1.3 Ensure mounting of jffs2 filesystems is disabled (Scored) " >> cis
echo "command : modprobe -n -v jffs2  " >> cis
modprobe -n -v jffs2   >> cis ; modprobe -n -v jffs2   2>> cis
echo "command : lsmod | grep jffs2  " >> cis
lsmod | grep jffs2  >> cis ; lsmod | grep jffs2  2>> cis

echo "1.1.1.4 Ensure mounting of hfs filesystems is disabled (Scored) " >> cis
echo "command : modprobe -n -v hfs   " >> cis
modprobe -n -v hfs    >> cis ; modprobe -n -v hfs    2>> cis
echo "command : lsmod | grep hfs   " >> cis
lsmod | grep hfs   >> cis ; lsmod | grep hfs 2>> cis

echo "1.1.1.5 Ensure mounting of hfsplus filesystems is disabled (Scored)" >> cis
echo "command : modprobe -n -v hfsplus   " >> cis
modprobe -n -v hfsplus    >> cis ; modprobe -n -v hfsplus     2>> cis
echo "command : lsmod | grep hfsplus    " >> cis
lsmod | grep hfsplus   >> cis ; lsmod | grep hfsplus  2>> cis

echo "1.1.1.6 Ensure mounting of squashfs filesystems is disabled (Scored)" >> cis
echo "command : modprobe -n -v squashfs    " >> cis
modprobe -n -v squashfs    >> cis ; modprobe -n -v squashfs      2>> cis
echo "command : lsmod | grep squashfs    " >> cis
lsmod | grep squashfs   >> cis ; lsmod | grep squashfs   2>> cis

echo "1.1.1.7 Ensure mounting of udf filesystems is disabled (Scored)" >> cis
echo "command : modprobe -n -v udf   " >> cis
modprobe -n -v udf    >> cis ; modprobe -n -v udf 2>> cis
echo "command : lsmod | grep udf    " >> cis
lsmod | grep udf  >> cis ; lsmod | grep udf   2>> cis

echo "1.1.1.8 Ensure mounting of FAT filesystems is disabled (Scored)" >> cis
echo "command : modprobe -n -v vfat   " >> cis
modprobe -n -v vfat    >> cis ; modprobe -n -v vfat 2>> cis
echo "command : lsmod | grep vfat    " >> cis
lsmod | grep vfat  >> cis ; lsmod | grep vfat   2>> cis

echo "1.1.2 Ensure separate partition exists for /tmp (Scored)" >> cis
echo "command : modprobe -n -v vfat   " >> cis
modprobe -n -v vfat    >> cis ; modprobe -n -v vfat 2>> cis
echo "command : lsmod | grep vfat    " >> cis
lsmod | grep vfat  >> cis ; lsmod | grep vfat   2>> cis


